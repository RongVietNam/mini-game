<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr√¨nh chi·∫øu ƒêa ph∆∞∆°ng ti·ªán</title>
    <link rel="stylesheet" href="styles.css">
    <!-- SortableJS for drag and drop (Sidebar only) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <button id="back-home-btn" class="btn-icon" title="V·ªÅ trang ch·ªß">üè†</button>
                <h1 class="app-title">Tr√¨nh chi·∫øu ƒêa ph∆∞∆°ng ti·ªán</h1>
            </div>
            <div class="header-right">
                <span class="project-name">Project: Mini Game</span>
            </div>
        </header>

        <!-- Main Body -->
        <div class="app-body">
            <!-- Left Sidebar: Resources & Settings -->
            <aside class="left-sidebar">
                <!-- Resources Section -->
                <div class="sidebar-section resources-section">
                    <div class="section-header">
                        <h3>T√†i nguy√™n</h3>
                        <button id="manage-resources-btn" class="btn-icon" title="Qu·∫£n l√Ω T√†i nguy√™n">‚öô</button>
                    </div>
                    <div class="resource-quick-actions">
                        <button id="add-resource-btn" class="btn-secondary btn-sm">Upload</button>
                        <button id="add-web-resource-btn" class="btn-secondary btn-sm">Link Web</button>
                        <button id="add-app-resource-btn" class="btn-primary btn-sm">Mini App</button>
                        <input type="file" id="add-resource-input" multiple style="display: none;">
                    </div>
                    <div id="resource-list" class="resource-list-mini">
                        <!-- Resource items will be injected here -->
                    </div>
                </div>

                <!-- Element Settings Section -->
                <div class="sidebar-section settings-section">
                    <div class="section-header">
                        <h3>C√†i ƒë·∫∑t Step</h3>
                    </div>
                    <div class="settings-content">
                        <div class="setting-group">
                            <label>T√™n Step:</label>
                            <input type="text" id="step-name-input" placeholder="Nh·∫≠p t√™n step...">
                        </div>
                        <div class="setting-group">
                            <label>Nh·∫°c n·ªÅn:</label>
                            <div class="audio-control">
                                <span id="step-audio-name" class="resource-name">Ch∆∞a c√≥</span>
                                <div class="audio-actions">
                                    <button id="select-step-audio-btn" class="btn-secondary btn-xs">Ch·ªçn</button>
                                    <button id="remove-audio-btn" class="btn-icon hidden" title="X√≥a">‚úï</button>
                                </div>
                            </div>
                            <div class="checkbox-group" style="margin-top: 5px;">
                                <label style="display: flex; align-items: center; gap: 5px; font-size: 0.85rem; cursor: pointer; color: #6c757d;">
                                    <input type="checkbox" id="step-audio-loop-checkbox"> T·ª± ƒë·ªông l·∫∑p l·∫°i
                                </label>
                            </div>
                            <audio id="audio-preview" controls style="display: none; width: 100%; margin-top: 5px; height: 30px;"></audio>
                        </div>
                        <!-- Future: Background color setting -->
                        <div class="step-actions-row">
                            <button id="copy-step-btn" class="btn-secondary btn-sm">Copy Step</button>
                            <button id="delete-step-btn" class="btn-danger btn-sm">X√≥a Step</button>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Main Editor Area -->
            <main class="editor-area" id="editor-area">
                <div class="frames-wrapper">
                    <div id="frames-canvas" class="frames-canvas">
                        <!-- Frames will be injected here as absolute positioned elements -->
                    </div>

                    <div class="canvas-toolbar">
                        <button id="add-frame-btn" class="btn-primary">+ Th√™m khung h√¨nh</button>
                        <button id="fullscreen-frame-btn" class="btn-secondary">Th√™m khung To√†n m√†n h√¨nh</button>
                    </div>
                </div>
            </main>
        </div>

        <!-- Footer -->
        <footer class="app-footer">
            <div class="footer-controls">
                <div class="data-actions">
                    <button id="import-btn" class="btn-secondary btn-sm">‚¨Ü Import</button>
                    <button id="export-btn" class="btn-secondary btn-sm">‚¨á Export</button>
                    <input type="file" id="import-file-input" accept=".json" style="display: none;">
                </div>
                <button id="present-btn" class="btn-success">‚ñ∂ Tr√¨nh chi·∫øu (Preview)</button>
            </div>

            <div class="step-list-container">
                <button id="add-step-btn" class="add-step-card">+ Th√™m Step</button>
                <div id="step-list" class="step-list-horizontal">
                    <!-- Steps will be injected here -->
                </div>
            </div>
        </footer>
    </div>

    <!-- Modal: Resource Manager (Full View) -->
    <div id="resource-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Qu·∫£n l√Ω T√†i nguy√™n</h3>
                <button class="close-modal-btn">‚úï</button>
            </div>
            <div class="modal-body">
                <p class="hint">Danh s√°ch ƒë·∫ßy ƒë·ªß c√°c t√†i nguy√™n trong d·ª± √°n.</p>
                <!-- This list is reused/re-rendered by script.js logic -->
                <div id="resource-list-full" class="resource-list"></div>
            </div>
            <div class="modal-footer">
                <button class="close-modal-btn btn-secondary">ƒê√≥ng</button>
            </div>
        </div>
    </div>

    <!-- Modal: Resource Selector (Picker) -->
    <div id="resource-picker-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Ch·ªçn T√†i nguy√™n</h3>
                <button class="close-picker-btn">‚úï</button>
            </div>
            <div class="modal-body">
                <div id="picker-list" class="resource-list">
                    <!-- Items to pick -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: App Configuration -->
    <div id="app-config-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>C·∫•u h√¨nh Mini App</h3>
                <button class="close-config-btn">‚úï</button>
            </div>
            <div class="modal-body">
                <p class="hint">Th√™m c√°c tham s·ªë (Parameters) ƒë·ªÉ truy·ªÅn v√†o URL c·ªßa App.</p>
                <div class="config-table-header">
                    <span>Key (T√™n tham s·ªë)</span>
                    <span>Value (Gi√° tr·ªã)</span>
                    <span></span>
                </div>
                <div id="config-params-list" class="config-params-list">
                    <!-- Param items -->
                </div>
                <button id="add-param-btn" class="btn-dashed" style="margin-top: 10px;">+ Th√™m tham s·ªë</button>
            </div>
            <div class="modal-footer">
                <button id="save-config-btn" class="btn-primary">L∆∞u C·∫•u h√¨nh</button>
            </div>
        </div>
    </div>

    <!-- Modal: Select Mini App -->
    <div id="select-app-modal" class="modal hidden">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3>Ch·ªçn Mini App</h3>
                <button class="close-select-app-btn">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="setting-group">
                    <label>Ch·ªçn App:</label>
                    <select id="mini-app-select" style="width: 100%; padding: 0.5rem; border-radius: 4px; border: 1px solid #dee2e6;">
                        <!-- Options will be injected here -->
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button id="confirm-add-app-btn" class="btn-primary">Th√™m</button>
            </div>
        </div>
    </div>

    <!-- Modal: Import Missing Resources -->
    <div id="import-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Kh√¥i ph·ª•c T√†i nguy√™n</h3>
                <p>Vui l√≤ng upload l·∫°i c√°c file t∆∞∆°ng ·ª©ng ƒë·ªÉ kh√¥i ph·ª•c d·ªØ li·ªáu.</p>
            </div>
            <div class="modal-body">
                <div class="import-toolbar" style="margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid #eee;">
                    <button id="auto-match-btn" class="btn-primary" style="width: 100%;">üìÇ Ch·ªçn nhi·ªÅu file ƒë·ªÉ t·ª± ƒë·ªông kh·ªõp</button>
                    <input type="file" id="auto-match-input" multiple style="display: none;">
                    <p class="hint" style="margin-top: 5px; font-size: 0.85rem;">Ch·ªçn t·∫•t c·∫£ ·∫£nh/video/nh·∫°c c√πng l√∫c. H·ªá th·ªëng s·∫Ω t·ª± ƒëi·ªÅn n·∫øu tr√πng t√™n file.</p>
                </div>
                <div id="missing-resource-list" class="missing-list">
                    <!-- Missing items -->
                </div>
            </div>
            <div class="modal-footer">
                <button id="finish-import-btn" class="btn-success">Ho√†n t·∫•t</button>
            </div>
        </div>
    </div>

    <!-- Template for a Frame Card -->
    <template id="frame-template">
        <div class="frame-card">
            <div class="frame-header">
                <span class="frame-title">Khung #</span>
                <div class="z-controls">
                    <button class="z-btn z-up" title="L√™n 1 l·ªõp">‚ñ≤</button>
                    <button class="z-btn z-down" title="Xu·ªëng 1 l·ªõp">‚ñº</button>
                    <button class="z-btn z-top" title="L√™n tr√™n c√πng">‚á™</button>
                    <button class="z-btn z-bottom" title="Xu·ªëng d∆∞·ªõi c√πng">‚á©</button>
                </div>
                <button class="frame-delete-btn btn-icon">‚úï</button>
            </div>
            <div class="frame-content">
                <div class="upload-placeholder">
                    <span>Ch·ªçn t·ª´ Th∆∞ vi·ªán</span>
                    <button class="btn-secondary btn-sm select-resource-btn">Ch·ªçn File/Link</button>
                </div>
                <div class="media-preview hidden">
                    <!-- img or video element -->
                </div>
            </div>
            <div class="frame-settings">
                <label class="checkbox-label">
                    <input type="checkbox" class="frame-loop-checkbox"> Loop
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" class="frame-autoplay-checkbox" checked> Auto
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" class="frame-cover-checkbox"> Fill
                </label>
                <button class="btn-secondary btn-xs config-app-btn hidden" title="C·∫•u h√¨nh App">‚öô Params</button>
            </div>
            <div class="resize-handle"></div>
        </div>
    </template>

    <script src="script.js"></script>
</body>
</html>
