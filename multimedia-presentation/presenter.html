<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Presenter View - Trình chiếu</title>
    <style>
        body {
            margin: 0;
            background-color: #1e1e1e;
            color: #fff;
            font-family: system-ui, -apple-system, sans-serif;
            height: 100vh;
            display: grid;
            grid-template-columns: 1fr 300px;
            grid-template-rows: 1fr 150px;
            grid-template-areas:
                "current next"
                "list list";
            overflow: hidden;
        }

        /* Current Slide Area */
        .current-slide-area {
            grid-area: current;
            border-right: 1px solid #333;
            border-bottom: 1px solid #333;
            display: flex;
            flex-direction: column;
            padding: 1rem;
            position: relative;
        }

        .area-header {
            font-size: 0.9rem;
            color: #aaa;
            margin-bottom: 0.5rem;
            display: flex;
            justify-content: space-between;
        }

        .slide-viewport {
            flex: 1;
            background: #000;
            position: relative;
            border: 1px solid #444;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Next Slide Area */
        .next-slide-area {
            grid-area: next;
            border-bottom: 1px solid #333;
            display: flex;
            flex-direction: column;
            padding: 1rem;
            background-color: #252526;
        }

        .next-viewport {
            flex: 1;
            background: #000;
            position: relative;
            border: 1px solid #444;
            opacity: 0.7;
        }

        /* Slide List Area */
        .slide-list-area {
            grid-area: list;
            background-color: #252526;
            display: flex;
            overflow-x: auto;
            padding: 1rem;
            gap: 1rem;
            align-items: center;
        }

        .slide-thumbnail {
            width: 160px;
            height: 100px;
            background: #333;
            border: 2px solid transparent;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            position: relative;
        }

        .slide-thumbnail.active {
            border-color: #0d6efd;
            box-shadow: 0 0 10px rgba(13, 110, 253, 0.5);
        }

        .thumb-content {
            flex: 1;
            background: #000;
            margin: 2px;
            position: relative;
            overflow: hidden;
        }

        .thumb-label {
            font-size: 0.75rem;
            padding: 2px 4px;
            background: rgba(0,0,0,0.7);
            color: #fff;
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Controls */
        .controls {
            margin-top: 1rem;
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            align-items: center;
        }

        button {
            padding: 0.5rem 1rem;
            cursor: pointer;
            background: #333;
            color: #fff;
            border: 1px solid #555;
            border-radius: 4px;
        }
        button:hover { background: #444; }
        button.primary { background: #0d6efd; border-color: #0d6efd; }
        button.primary:hover { background: #0b5ed7; }

        button.warning { background: #ffc107; color: #000; border-color: #ffc107; }
        button.warning:hover { background: #e0a800; }

        .btn-icon {
            padding: 0.5rem;
            font-size: 1.2rem;
            line-height: 1;
        }

        /* Settings Popover */
        .settings-popover {
            position: absolute;
            bottom: 60px;
            left: 50%;
            transform: translateX(-50%);
            background: #252526;
            border: 1px solid #555;
            border-radius: 4px;
            padding: 1rem;
            width: 250px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
            z-index: 100;
            display: none;
        }
        .settings-popover.active { display: block; }

        .settings-group { margin-bottom: 1rem; }
        .settings-group:last-child { margin-bottom: 0; }
        .settings-label { display: block; margin-bottom: 0.5rem; font-size: 0.9rem; color: #aaa; }

        .radio-group { display: flex; flex-direction: column; gap: 0.5rem; }
        .radio-label { display: flex; align-items: center; gap: 0.5rem; font-size: 0.9rem; cursor: pointer; }

        /* Helper classes for rendering frames inside viewports */
        .mini-canvas {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        .mini-frame {
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        .mini-frame img, .mini-frame video {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        .mini-frame.fit-cover img, .mini-frame.fit-cover video {
            object-fit: cover;
        }
    </style>
</head>
<body>
    <div class="current-slide-area">
        <div class="area-header">
            <span>ĐANG CHIẾU: <strong id="current-step-name">Step 1</strong></span>
            <span id="clock">00:00</span>
        </div>
        <div id="current-viewport" class="slide-viewport"></div>

        <div class="controls">
            <button id="prev-btn">◀ Trước</button>

            <div style="position: relative;">
                <button id="pause-btn" class="warning">⏸ Tạm dừng</button>
                <button id="pause-settings-btn" class="btn-icon" title="Cài đặt Tạm dừng">⚙</button>

                <div id="pause-settings-popover" class="settings-popover">
                    <div class="settings-group">
                        <span class="settings-label">Màn hình khi tạm dừng:</span>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="pause-mode" value="black" checked> Màn hình đen
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="pause-mode" value="freeze"> Giữ nguyên hình ảnh
                            </label>
                        </div>
                    </div>
                    <div class="settings-group">
                        <span class="settings-label">Âm thanh khi tạm dừng:</span>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="pause-audio" value="mute" checked> Tắt nhạc nền
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="pause-audio" value="keep"> Giữ nguyên nhạc nền
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <button id="next-btn" class="primary">Tiếp theo ▶</button>
            <button id="end-btn" style="margin-left: auto; background: #dc3545; border-color: #dc3545;">Kết thúc</button>
        </div>
    </div>

    <div class="next-slide-area">
        <div class="area-header">
            <span>TIẾP THEO: <strong id="next-step-name">Step 2</strong></span>
        </div>
        <div id="next-viewport" class="next-viewport"></div>
    </div>

    <div class="slide-list-area" id="slide-list">
        <!-- Thumbnails injected here -->
    </div>

    <script src="presenter.js"></script>
</body>
</html>
